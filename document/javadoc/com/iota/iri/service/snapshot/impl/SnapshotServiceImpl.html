<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_201) on Fri Feb 21 16:49:00 CST 2020 -->
<title>SnapshotServiceImpl</title>
<meta name="date" content="2020-02-21">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="SnapshotServiceImpl";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../com/iota/iri/service/snapshot/impl/SnapshotProviderImpl.html" title="class in com.iota.iri.service.snapshot.impl"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../com/iota/iri/service/snapshot/impl/SnapshotStateDiffImpl.html" title="class in com.iota.iri.service.snapshot.impl"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?com/iota/iri/service/snapshot/impl/SnapshotServiceImpl.html" target="_top">Frames</a></li>
<li><a href="SnapshotServiceImpl.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.iota.iri.service.snapshot.impl</div>
<h2 title="Class SnapshotServiceImpl" class="title">Class SnapshotServiceImpl</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.iota.iri.service.snapshot.impl.SnapshotServiceImpl</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html" title="interface in com.iota.iri.service.snapshot">SnapshotService</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">SnapshotServiceImpl</span>
extends java.lang.Object
implements <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html" title="interface in com.iota.iri.service.snapshot">SnapshotService</a></pre>
<div class="block">Implements the basic contract of the <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html" title="interface in com.iota.iri.service.snapshot"><code>SnapshotService</code></a>.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../com/iota/iri/service/snapshot/impl/SnapshotServiceImpl.html#SnapshotServiceImpl--">SnapshotServiceImpl</a></span>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>java.util.Map&lt;<a href="../../../../../../com/iota/iri/model/Hash.html" title="interface in com.iota.iri.model">Hash</a>,java.lang.Integer&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/iota/iri/service/snapshot/impl/SnapshotServiceImpl.html#generateSeenMilestones-com.iota.iri.storage.Tangle-com.iota.iri.conf.SnapshotConfig-com.iota.iri.validator.MilestoneTracker-com.iota.iri.controllers.MilestoneViewModel-">generateSeenMilestones</a></span>(<a href="../../../../../../com/iota/iri/storage/Tangle.html" title="class in com.iota.iri.storage">Tangle</a>&nbsp;tangle,
                      <a href="../../../../../../com/iota/iri/conf/SnapshotConfig.html" title="interface in com.iota.iri.conf">SnapshotConfig</a>&nbsp;config,
                      <a href="../../../../../../com/iota/iri/validator/MilestoneTracker.html" title="class in com.iota.iri.validator">MilestoneTracker</a>&nbsp;milestoneTracker,
                      <a href="../../../../../../com/iota/iri/controllers/MilestoneViewModel.html" title="class in com.iota.iri.controllers">MilestoneViewModel</a>&nbsp;targetMilestone)</code>
<div class="block">This method generates the map of seen milestones that happened after the given target milestone.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot">Snapshot</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/iota/iri/service/snapshot/impl/SnapshotServiceImpl.html#generateSnapshot-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.SnapshotProvider-com.iota.iri.conf.SnapshotConfig-com.iota.iri.validator.MilestoneTracker-com.iota.iri.controllers.MilestoneViewModel-">generateSnapshot</a></span>(<a href="../../../../../../com/iota/iri/storage/Tangle.html" title="class in com.iota.iri.storage">Tangle</a>&nbsp;tangle,
                <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotProvider.html" title="interface in com.iota.iri.service.snapshot">SnapshotProvider</a>&nbsp;snapshotProvider,
                <a href="../../../../../../com/iota/iri/conf/SnapshotConfig.html" title="interface in com.iota.iri.conf">SnapshotConfig</a>&nbsp;config,
                <a href="../../../../../../com/iota/iri/validator/MilestoneTracker.html" title="class in com.iota.iri.validator">MilestoneTracker</a>&nbsp;milestoneTracker,
                <a href="../../../../../../com/iota/iri/controllers/MilestoneViewModel.html" title="class in com.iota.iri.controllers">MilestoneViewModel</a>&nbsp;targetMilestone)</code>
<div class="block">This method generates a local snapshot of the full ledger state at the given milestone.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>java.util.Map&lt;<a href="../../../../../../com/iota/iri/model/Hash.html" title="interface in com.iota.iri.model">Hash</a>,java.lang.Integer&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/iota/iri/service/snapshot/impl/SnapshotServiceImpl.html#generateSolidEntryPoints-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.SnapshotProvider-com.iota.iri.controllers.MilestoneViewModel-">generateSolidEntryPoints</a></span>(<a href="../../../../../../com/iota/iri/storage/Tangle.html" title="class in com.iota.iri.storage">Tangle</a>&nbsp;tangle,
                        <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotProvider.html" title="interface in com.iota.iri.service.snapshot">SnapshotProvider</a>&nbsp;snapshotProvider,
                        <a href="../../../../../../com/iota/iri/controllers/MilestoneViewModel.html" title="class in com.iota.iri.controllers">MilestoneViewModel</a>&nbsp;targetMilestone)</code>
<div class="block">This method generates the solid entry points for a snapshot that belong to the given milestone.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/iota/iri/service/snapshot/impl/SnapshotServiceImpl.html#replayMilestones-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.Snapshot-int-">replayMilestones</a></span>(<a href="../../../../../../com/iota/iri/storage/Tangle.html" title="class in com.iota.iri.storage">Tangle</a>&nbsp;tangle,
                <a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot">Snapshot</a>&nbsp;snapshot,
                int&nbsp;targetMilestoneIndex)</code>
<div class="block">This method applies the balance changes that are introduced by future milestones to the current Snapshot.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/iota/iri/service/snapshot/impl/SnapshotServiceImpl.html#rollBackMilestones-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.Snapshot-int-">rollBackMilestones</a></span>(<a href="../../../../../../com/iota/iri/storage/Tangle.html" title="class in com.iota.iri.storage">Tangle</a>&nbsp;tangle,
                  <a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot">Snapshot</a>&nbsp;snapshot,
                  int&nbsp;targetMilestoneIndex)</code>
<div class="block">This method rolls back the latest milestones until it reaches the state that the snapshot had before applying
 the milestone indicated by the given parameter.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/iota/iri/service/snapshot/impl/SnapshotServiceImpl.html#takeLocalSnapshot-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.SnapshotProvider-com.iota.iri.conf.SnapshotConfig-com.iota.iri.validator.MilestoneTracker-com.iota.iri.service.transactionpruning.TransactionPruner-">takeLocalSnapshot</a></span>(<a href="../../../../../../com/iota/iri/storage/Tangle.html" title="class in com.iota.iri.storage">Tangle</a>&nbsp;tangle,
                 <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotProvider.html" title="interface in com.iota.iri.service.snapshot">SnapshotProvider</a>&nbsp;snapshotProvider,
                 <a href="../../../../../../com/iota/iri/conf/SnapshotConfig.html" title="interface in com.iota.iri.conf">SnapshotConfig</a>&nbsp;config,
                 <a href="../../../../../../com/iota/iri/validator/MilestoneTracker.html" title="class in com.iota.iri.validator">MilestoneTracker</a>&nbsp;milestoneTracker,
                 <a href="../../../../../../com/iota/iri/service/transactionpruning/TransactionPruner.html" title="interface in com.iota.iri.service.transactionpruning">TransactionPruner</a>&nbsp;transactionPruner)</code>
<div class="block">This method takes a "full" local snapshot according to the configuration of the node.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="SnapshotServiceImpl--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>SnapshotServiceImpl</h4>
<pre>public&nbsp;SnapshotServiceImpl()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="replayMilestones-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.Snapshot-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>replayMilestones</h4>
<pre>public&nbsp;void&nbsp;replayMilestones(<a href="../../../../../../com/iota/iri/storage/Tangle.html" title="class in com.iota.iri.storage">Tangle</a>&nbsp;tangle,
                             <a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot">Snapshot</a>&nbsp;snapshot,
                             int&nbsp;targetMilestoneIndex)
                      throws <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotException.html" title="class in com.iota.iri.service.snapshot">SnapshotException</a></pre>
<div class="block">This method applies the balance changes that are introduced by future milestones to the current Snapshot.

 It iterates over the milestone indexes starting from the current index to the target index and applies all found
 milestone balances. If it can not find a milestone for a certain index it keeps track of these skipped
 milestones, which allows us to revert the changes even if the missing milestone was received and processed in the
 mean time. If the application of changes fails, we restore the state of the snapshot to the one it had before the
 application attempt so this method only modifies the Snapshot if it succeeds.

 Note: the changes done by this method can be reverted by using <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html#rollBackMilestones-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.Snapshot-int-"><code>SnapshotService.rollBackMilestones(Tangle, Snapshot, int)</code></a></div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html#replayMilestones-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.Snapshot-int-">replayMilestones</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html" title="interface in com.iota.iri.service.snapshot">SnapshotService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tangle</code> - Tangle object which acts as a database interface</dd>
<dd><code>snapshot</code> - the Snapshot that shall get modified</dd>
<dd><code>targetMilestoneIndex</code> - the index of the milestone that should be applied</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotException.html" title="class in com.iota.iri.service.snapshot">SnapshotException</a></code> - if something goes wrong while applying the changes</dd>
</dl>
</li>
</ul>
<a name="rollBackMilestones-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.Snapshot-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>rollBackMilestones</h4>
<pre>public&nbsp;void&nbsp;rollBackMilestones(<a href="../../../../../../com/iota/iri/storage/Tangle.html" title="class in com.iota.iri.storage">Tangle</a>&nbsp;tangle,
                               <a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot">Snapshot</a>&nbsp;snapshot,
                               int&nbsp;targetMilestoneIndex)
                        throws <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotException.html" title="class in com.iota.iri.service.snapshot">SnapshotException</a></pre>
<div class="block">This method rolls back the latest milestones until it reaches the state that the snapshot had before applying
 the milestone indicated by the given parameter.

 When rolling back the milestones we take previously skipped milestones into account, so this method should give
 the correct result, even if the missing milestones were received and processed in the mean time. If the rollback
 fails, we restore the state of the snapshot to the one it had before the rollback attempt so this method only
 modifies the Snapshot if it succeeds.

 Note: this method is used to reverse the changes introduced by <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html#replayMilestones-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.Snapshot-int-"><code>SnapshotService.replayMilestones(Tangle, Snapshot, int)</code></a></div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html#rollBackMilestones-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.Snapshot-int-">rollBackMilestones</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html" title="interface in com.iota.iri.service.snapshot">SnapshotService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tangle</code> - Tangle object which acts as a database interface</dd>
<dd><code>snapshot</code> - the Snapshot that shall get modified</dd>
<dd><code>targetMilestoneIndex</code> - the index of the milestone that should be rolled back (including all following
                             milestones that were applied)</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotException.html" title="class in com.iota.iri.service.snapshot">SnapshotException</a></code> - if something goes wrong while reverting the changes</dd>
</dl>
</li>
</ul>
<a name="takeLocalSnapshot-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.SnapshotProvider-com.iota.iri.conf.SnapshotConfig-com.iota.iri.validator.MilestoneTracker-com.iota.iri.service.transactionpruning.TransactionPruner-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>takeLocalSnapshot</h4>
<pre>public&nbsp;void&nbsp;takeLocalSnapshot(<a href="../../../../../../com/iota/iri/storage/Tangle.html" title="class in com.iota.iri.storage">Tangle</a>&nbsp;tangle,
                              <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotProvider.html" title="interface in com.iota.iri.service.snapshot">SnapshotProvider</a>&nbsp;snapshotProvider,
                              <a href="../../../../../../com/iota/iri/conf/SnapshotConfig.html" title="interface in com.iota.iri.conf">SnapshotConfig</a>&nbsp;config,
                              <a href="../../../../../../com/iota/iri/validator/MilestoneTracker.html" title="class in com.iota.iri.validator">MilestoneTracker</a>&nbsp;milestoneTracker,
                              <a href="../../../../../../com/iota/iri/service/transactionpruning/TransactionPruner.html" title="interface in com.iota.iri.service.transactionpruning">TransactionPruner</a>&nbsp;transactionPruner)
                       throws <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotException.html" title="class in com.iota.iri.service.snapshot">SnapshotException</a></pre>
<div class="block">This method takes a "full" local snapshot according to the configuration of the node.

 It first determines the necessary configuration parameters and which milestone to us as a reference. It then
 generates the local <a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot"><code>Snapshot</code></a>, issues the the required <a href="../../../../../../com/iota/iri/service/transactionpruning/TransactionPruner.html" title="interface in com.iota.iri.service.transactionpruning"><code>TransactionPruner</code></a> jobs and writes the
 resulting <a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot"><code>Snapshot</code></a> to the disk.

 After persisting the local snapshot on the hard disk of the node, it updates the <a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot"><code>Snapshot</code></a> instances used
 by the <code>snapshotProvider</code> to reflect the newly created <a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot"><code>Snapshot</code></a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html#takeLocalSnapshot-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.SnapshotProvider-com.iota.iri.conf.SnapshotConfig-com.iota.iri.validator.MilestoneTracker-com.iota.iri.service.transactionpruning.TransactionPruner-">takeLocalSnapshot</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html" title="interface in com.iota.iri.service.snapshot">SnapshotService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tangle</code> - Tangle object which acts as a database interface</dd>
<dd><code>snapshotProvider</code> - data provider for the <a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot"><code>Snapshot</code></a>s that are relevant for the node</dd>
<dd><code>config</code> - important snapshot related configuration parameters</dd>
<dd><code>milestoneTracker</code> - milestone tracker that allows us to retrieve information about the known milestones</dd>
<dd><code>transactionPruner</code> - manager for the pruning jobs that takes care of cleaning up the old data that</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotException.html" title="class in com.iota.iri.service.snapshot">SnapshotException</a></code> - if anything goes wrong while creating the local snapshot</dd>
</dl>
</li>
</ul>
<a name="generateSnapshot-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.SnapshotProvider-com.iota.iri.conf.SnapshotConfig-com.iota.iri.validator.MilestoneTracker-com.iota.iri.controllers.MilestoneViewModel-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateSnapshot</h4>
<pre>public&nbsp;<a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot">Snapshot</a>&nbsp;generateSnapshot(<a href="../../../../../../com/iota/iri/storage/Tangle.html" title="class in com.iota.iri.storage">Tangle</a>&nbsp;tangle,
                                 <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotProvider.html" title="interface in com.iota.iri.service.snapshot">SnapshotProvider</a>&nbsp;snapshotProvider,
                                 <a href="../../../../../../com/iota/iri/conf/SnapshotConfig.html" title="interface in com.iota.iri.conf">SnapshotConfig</a>&nbsp;config,
                                 <a href="../../../../../../com/iota/iri/validator/MilestoneTracker.html" title="class in com.iota.iri.validator">MilestoneTracker</a>&nbsp;milestoneTracker,
                                 <a href="../../../../../../com/iota/iri/controllers/MilestoneViewModel.html" title="class in com.iota.iri.controllers">MilestoneViewModel</a>&nbsp;targetMilestone)
                          throws <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotException.html" title="class in com.iota.iri.service.snapshot">SnapshotException</a></pre>
<div class="block">This method generates a local snapshot of the full ledger state at the given milestone.

 The generated <a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot"><code>Snapshot</code></a> contains the balances and meta data plus the derived values like the solid entry
 points and all seen milestones, that were issued after the snapshot and can therefore be used to generate the
 local snapshot files.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html#generateSnapshot-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.SnapshotProvider-com.iota.iri.conf.SnapshotConfig-com.iota.iri.validator.MilestoneTracker-com.iota.iri.controllers.MilestoneViewModel-">generateSnapshot</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html" title="interface in com.iota.iri.service.snapshot">SnapshotService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tangle</code> - Tangle object which acts as a database interface</dd>
<dd><code>snapshotProvider</code> - data provider for the <a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot"><code>Snapshot</code></a>s that are relevant for the node</dd>
<dd><code>config</code> - important snapshot related configuration parameters</dd>
<dd><code>milestoneTracker</code> - milestone tracker that allows us to retrieve information about the known milestones</dd>
<dd><code>targetMilestone</code> - milestone that is used as a reference point for the snapshot</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a local snapshot of the full ledger state at the given milestone</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotException.html" title="class in com.iota.iri.service.snapshot">SnapshotException</a></code> - if anything goes wrong while generating the local snapshot</dd>
</dl>
</li>
</ul>
<a name="generateSolidEntryPoints-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.SnapshotProvider-com.iota.iri.controllers.MilestoneViewModel-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateSolidEntryPoints</h4>
<pre>public&nbsp;java.util.Map&lt;<a href="../../../../../../com/iota/iri/model/Hash.html" title="interface in com.iota.iri.model">Hash</a>,java.lang.Integer&gt;&nbsp;generateSolidEntryPoints(<a href="../../../../../../com/iota/iri/storage/Tangle.html" title="class in com.iota.iri.storage">Tangle</a>&nbsp;tangle,
                                                                      <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotProvider.html" title="interface in com.iota.iri.service.snapshot">SnapshotProvider</a>&nbsp;snapshotProvider,
                                                                      <a href="../../../../../../com/iota/iri/controllers/MilestoneViewModel.html" title="class in com.iota.iri.controllers">MilestoneViewModel</a>&nbsp;targetMilestone)
                                                               throws <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotException.html" title="class in com.iota.iri.service.snapshot">SnapshotException</a></pre>
<div class="block">This method generates the solid entry points for a snapshot that belong to the given milestone.

 A solid entry point is a confirmed transaction that had non-orphaned approvers during the time of the snapshot
 creation and therefore a connection to the most recent part of the tangle. The solid entry points allow us to
 stop the solidification process without having to go all the way back to the genesis.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html#generateSolidEntryPoints-com.iota.iri.storage.Tangle-com.iota.iri.service.snapshot.SnapshotProvider-com.iota.iri.controllers.MilestoneViewModel-">generateSolidEntryPoints</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html" title="interface in com.iota.iri.service.snapshot">SnapshotService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tangle</code> - Tangle object which acts as a database interface</dd>
<dd><code>snapshotProvider</code> - data provider for the <a href="../../../../../../com/iota/iri/service/snapshot/Snapshot.html" title="interface in com.iota.iri.service.snapshot"><code>Snapshot</code></a>s that are relevant for the node</dd>
<dd><code>targetMilestone</code> - milestone that is used as a reference point for the snapshot</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a map of solid entry points associating their hash to the milestone index that confirmed them</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotException.html" title="class in com.iota.iri.service.snapshot">SnapshotException</a></code> - if anything goes wrong while generating the solid entry points</dd>
</dl>
</li>
</ul>
<a name="generateSeenMilestones-com.iota.iri.storage.Tangle-com.iota.iri.conf.SnapshotConfig-com.iota.iri.validator.MilestoneTracker-com.iota.iri.controllers.MilestoneViewModel-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>generateSeenMilestones</h4>
<pre>public&nbsp;java.util.Map&lt;<a href="../../../../../../com/iota/iri/model/Hash.html" title="interface in com.iota.iri.model">Hash</a>,java.lang.Integer&gt;&nbsp;generateSeenMilestones(<a href="../../../../../../com/iota/iri/storage/Tangle.html" title="class in com.iota.iri.storage">Tangle</a>&nbsp;tangle,
                                                                    <a href="../../../../../../com/iota/iri/conf/SnapshotConfig.html" title="interface in com.iota.iri.conf">SnapshotConfig</a>&nbsp;config,
                                                                    <a href="../../../../../../com/iota/iri/validator/MilestoneTracker.html" title="class in com.iota.iri.validator">MilestoneTracker</a>&nbsp;milestoneTracker,
                                                                    <a href="../../../../../../com/iota/iri/controllers/MilestoneViewModel.html" title="class in com.iota.iri.controllers">MilestoneViewModel</a>&nbsp;targetMilestone)
                                                             throws <a href="../../../../../../com/iota/iri/service/snapshot/SnapshotException.html" title="class in com.iota.iri.service.snapshot">SnapshotException</a></pre>
<div class="block">This method generates the map of seen milestones that happened after the given target milestone.

 The map contains the hashes of the milestones associated to their milestone index and is used to allow nodes
 that use local snapshot files to bootstrap their nodes, to faster request the missing milestones when syncing the
 very first time.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html#generateSeenMilestones-com.iota.iri.storage.Tangle-com.iota.iri.conf.SnapshotConfig-com.iota.iri.validator.MilestoneTracker-com.iota.iri.controllers.MilestoneViewModel-">generateSeenMilestones</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotService.html" title="interface in com.iota.iri.service.snapshot">SnapshotService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tangle</code> - Tangle object which acts as a database interface</dd>
<dd><code>config</code> - important snapshot related configuration parameters</dd>
<dd><code>milestoneTracker</code> - milestone tracker that allows us to retrieve information about the known milestones</dd>
<dd><code>targetMilestone</code> - milestone that is used as a reference point for the snapshot</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a map of solid entry points associating their hash to the milestone index that confirmed them</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../com/iota/iri/service/snapshot/SnapshotException.html" title="class in com.iota.iri.service.snapshot">SnapshotException</a></code> - if anything goes wrong while generating the solid entry points</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../com/iota/iri/service/snapshot/impl/SnapshotProviderImpl.html" title="class in com.iota.iri.service.snapshot.impl"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../com/iota/iri/service/snapshot/impl/SnapshotStateDiffImpl.html" title="class in com.iota.iri.service.snapshot.impl"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?com/iota/iri/service/snapshot/impl/SnapshotServiceImpl.html" target="_top">Frames</a></li>
<li><a href="SnapshotServiceImpl.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
